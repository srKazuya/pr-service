# Question-Answer Service
**REST API сервис для работы с вопросами и ответами**
Простой, масштабируемый и типичный «чистый» Go-сервис с разделением на слои, валидацией, миграциями.
### Стек технологий
- **Go** 1.23+
- **Chi** — легковесный роутер
- **PostgreSQL** 15+
- **Docker + Docker Compose**
- **cleanenv** для загрузки конфигурации
- Миграции **goose**
- ORM **gorm*
- Валидация через **github.com/go-playground/validator**
- Логирование — **slog**
- **gofakeit** — сиды с реалистичными данными
####Готовая коллекция с примерами всех запросов:
/Pull Requests.postman_collection.json

## Быстрый старт (Docker Compose)
### 1. Запуск
```bash
make up
```
Сервис будет доступен по адресу:  
**http://localhost:8080/**
По желанию порт можно помеять в файле конфигурации`
**config/dev.yaml** ->http_server: address: "0.0.0.0:8080"

### 2. Остановка
```bash
make down                    # остановить контейнеры
make drop                    # + удалить volume с БД (полная очистка)
```

## Конфигурация
Все параметры загружаются из ``config/.yaml`` файла.

| Переменная окружения**         | Поле в YAML-конфиге                   | Описание                          | Значение в dev.yaml   | По умолчанию (если не задано) |
|--------------------------------|---------------------------------------|-----------------------------------|-----------------------|--------------------------------|
| `CONFIG_PATH`                  | —                                     | Путь к YAML-файлу конфигурации    | `/app/config/dev.yaml`| — в Docker.compose             |
| —                              | `env`                                 | Окружение (dev/prod/local)        | `dev`                 | —                              |
| —                              | `http_server.address`                 | Адрес и порт HTTP-сервера         | `0.0.0.0:8080`        | —                              |
| —                              | `http_server.timeout`                 | Общий таймаут сервера             | `4s`                  | —                              |
| —                              | `http_server.idle_timeout`            | Idle timeout                      | `30s`                 | —                              |
| —                              | `database.host`                       | Хост PostgreSQL                   | `pr_postgres`         | —                              |
| —                              | `database.port`                       | Порт PostgreSQL                   | `5432`                | —                              |
| —                              | `database.user`                       | Пользователь БД                   | `postgres`            | —                              |
| —                              | `database.password`                   | Пароль БД                         | `postgres`            | —                              |
| —                              | `database.dbname`                     | Имя базы данных                   | `pullrequest`         | —                              |
| —                              | `database.sslmode`                    | Режим SSL                         | `disable`             | —                              |

Миграции автоматически применяются при старте приложения.

## API Эндпоинты
| Метод  | Путь                            | Описание                                                                  |
|-------|----------------------------------|-------------------------------------------------------------------------- |
| `POST`  | `/pullRequest/create`            | Создать PR + автоматически назначить до 2 ревьюверов из команды автора  |
| `POST`  | `/pullRequest/merge`             | Пометить PR как MERGED (идемпотентно)                                   |
| `POST`  | `/pullRequest/reassign`          | Переназначить ревьювера на другого из его команды                       |
| `POST`  | `/team/add`                      | Создать команду (создаёт/обновляет пользователей)                       |
| `GET`   | `/team/get?team_name=Alpha`      | Получить команду с участниками                                          |
| `GET`   | `/users/getReview?user_id=xxx`   | Получить все PR, где пользователь назначен ревьювером                   |
| `POST`  | `/users/setIsActive`             | Установить флаг активности пользователя                                 |


